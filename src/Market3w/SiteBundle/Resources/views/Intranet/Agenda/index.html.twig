{% extends 'Market3wSiteBundle::backendLayout.html.twig' %}

{% block content %}
    <div class="fixed_content">
        <h1>Rendez-vous à venir</h1>
        <table>
            <thead>
                <th> Etat    </th>
                <th> Date    </th>
                <th> Heure   </th>
                <th> Type    </th>
                <th> Client  </th>
                <th> Société </th>
                <th> Sujet   </th>
                <th> Actions </th>
            </thead>
            <tbody>
                {% for appointment in appointments %}
                    <tr>
                        <td> 
                            {% if appointment.confirmed == false  %}
                                En attente de confirmation
                            {% else %}
                                Confirmé
                            {% endif %}
                        </td>
                        <td> {{ appointment.date|date("d/m/Y") }}                                     </td>
                        <td> {{ appointment.hour|date("H:i") }}                                       </td>
                        <td> {{ appointment.type.name }}                                              </td>
                        <td> {{ appointment.prospect.firstName }} {{ appointment.prospect.lastName }} </td>
                        <td> {{ appointment.prospect.company.name }}                                  </td>
                        <td> {{ appointment.subject | slice(0, 150) }}...                             </td>
                        <td> 
                            <a href="{{ path('agenda_show_appointment', {'id':appointment.id}) }}"> Détail </a>
                            <a href="">Modifier</a>
                            {% if appointment.confirmed == false  %}
                                <a href="">Confirmer</a>
                            {% endif %}
                            {% if appointment.type.id == 2 and appointment.confirmed == true  %}
                                {% include 'Market3wSiteBundle:Intranet/Agenda:_skypeCallButton.html.twig' with {'pseudo' : appointment.prospect.skypePseudo} %}
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}